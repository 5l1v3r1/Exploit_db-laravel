<?php

namespace App;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Support\Facades\DB;
class Category extends Model
{
    protected $table = 'category';
    protected $fillable = ['name'];

    public static function boot() {
        parent::boot();
        static::deleting(function($category) { 
             $category->exploits()->delete();
             $category->categories()->delete();
        });
    }
    public function exploits()
    {
    	return $this->hasMany('App\Exploit');
    }
    /**
	* Get the sub categories for the category.
 	*/ 
    public function categories()
    {
    	return $this->hasMany(Category::class);
    }
    /**
 	* Get the parent category that own the category.
 	*/
    public function parent()
    {
    	return $this->belongTo(Category::class);
    }

    public static function getCategory($id)
    {
        $category = DB::select('select * from category where id = :id' , ['id' => $id]);
        return $category ;
    }
    public static function getChildOfRoot()
    {
        return DB::select('select * from category where category_id = :root' , ['root' => 0 ]);
    }

}
